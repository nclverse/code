<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Table of Contents</title>
<link href="http://fonts.googleapis.com/css?family=Fira+Sans:300,400,500,700|Inconsolata" rel="stylesheet" type="text/css" />

    <link href="http://nclverse.github.io/code/css/styles.css" media="all" rel="stylesheet" type="text/css" />
  </head>
  <body>
    <section id="container">
      <section id="sidebar"><nav id="main-nav">
  <header id="title">
    <img class="site-logo" alt="logo" src="http://nclverse.github.io/code/img/logo.svg" />
    <div class="titles">
      <span class="verse-title">NCL<strong>Verse</strong></span>
      <ul class="docs-site">
        <li><a class="active" href="http://nclverse.github.io/code">Code</a></li><li><a href="http://nclverse.github.io/dissertation">Dissertation</a></li><li><a href="http://nclverse.github.io/design">Design</a></li><li><a href="http://nclverse.github.io/help">Help</a></li>
      </ul>
    </div>
  </header>
  <div class="category">
    <header class="category-title"><h1>apps<span class="count">234 LOC</span></h1></header>
    <ul class="titles">
      <li><a class="title-link">Architecture<span class="count">0 LOC</span></a>
        <ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/apps/architecture/core-ideas.html">Core Ideas<span class="count">0</span></a></li></ul>
      </li>
      </ul><ul class="titles">
      <li><a class="title-link active">Exams<span class="count">234 LOC</span></a>
        <ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/apps/exams/leechness.html">Leechness<span class="count">24</span></a></li></ul><ul class="subtitles"><li> <a class="subtitle-link active" href="http://nclverse.github.io/code/apps/exams/gateway.html">Gateway<span class="count">56</span></a></li></ul><ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/apps/exams/handler.html">Handler<span class="count">18</span></a></li></ul><ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/apps/exams/home.html">Home<span class="count">56</span></a></li></ul><ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/apps/exams/layout.html">Layout<span class="count">39</span></a></li></ul><ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/apps/exams/transforms.html">Transforms<span class="count">41</span></a></li></ul>
      </li>
      </ul>
  </div><div class="category">
    <header class="category-title"><h1>utilities<span class="count">269 LOC</span></h1></header>
    <ul class="titles">
      <li><a class="title-link">Docs Generator<span class="count">269 LOC</span></a>
        <ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/utilities/docs-generator/architecture.html">Architecture<span class="count">0</span></a></li></ul><ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/utilities/docs-generator/overview.html">Overview<span class="count">0</span></a></li></ul><ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/utilities/docs-generator/collect.html">Collect<span class="count">48</span></a></li></ul><ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/utilities/docs-generator/transform.html">Transform<span class="count">95</span></a></li></ul><ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/utilities/docs-generator/render.html">Render<span class="count">126</span></a></li></ul><ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/utilities/docs-generator/roadmap.html">Roadmap<span class="count">0</span></a></li></ul>
      </li>
      </ul>
  </div><div class="category">
    <header class="category-title"><h1>tests<span class="count">95 LOC</span></h1></header>
    <ul class="titles">
      <li><a class="title-link">Docs Generator<span class="count">95 LOC</span></a>
        <ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/tests/docs-generator/collect.html">Collect<span class="count">45</span></a></li></ul><ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/tests/docs-generator/transform.html">Transform<span class="count">20</span></a></li></ul><ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/tests/docs-generator/render.html">Render<span class="count">30</span></a></li></ul>
      </li>
      </ul>
  </div>

</nav></section>
      <section id="read-area"><article class="post">
  <section class="content"><div id="table-of-contents">
<h1>Table of Contents</h1>
<div id="text-table-of-contents">
<ul>
<li><a href="Malformed">1. Namespaces</a></li>
<li><a href="Malformed">2. Login Regex</a></li>
<li><a href="Malformed">3. Gateway Display</a></li>
<li><a href="Malformed">4. Scraper</a></li>
<li><a href="Malformed">5. Get credentials</a></li>
<li><a href="Malformed">6. Get modules</a></li>
<li><a href="Malformed">7. Validation</a>
<ul>
<li><a href="Malformed">7.1. Check for Demo</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1" class="outline-1">
<h1 id="sec-1"><span class="section-number-1">1</span> Namespaces</h1>
<div class="outline-text-1" id="text-1">
<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="kd">ns </span><span class="nv">exam-vault.routes.gateway</span>
  <span class="p">(</span><span class="ss">:require</span> <span class="p">[</span><span class="nv">compojure.core</span> <span class="ss">:refer</span> <span class="ss">:all</span><span class="p">]</span>
	    <span class="p">[</span><span class="nv">ring.util.response</span> <span class="ss">:as</span> <span class="nv">resp</span><span class="p">]</span>
	    <span class="p">[</span><span class="nv">net.cgrand.enlive-html</span> <span class="ss">:as</span> <span class="nv">enlive</span><span class="p">]</span>
	    <span class="p">[</span><span class="nv">hiccup.form</span> <span class="ss">:refer</span> <span class="p">[</span><span class="nv">form-to</span> <span class="nv">text-field</span> <span class="nv">password-field</span> <span class="nv">submit-button</span><span class="p">]]</span>
	    <span class="p">[</span><span class="nv">exam-vault.leechness</span> <span class="ss">:as</span> <span class="nv">leech</span><span class="p">]</span>
	    <span class="p">[</span><span class="nv">exam-vault.views.layout</span> <span class="ss">:as</span> <span class="nv">layout</span><span class="p">]))</span>
</pre></div>

</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-1">
<h1 id="sec-2"><span class="section-number-1">2</span> Login Regex</h1>
<div class="outline-text-1" id="text-2">
<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="k">def </span><span class="nv">login-regex</span> <span class="o">#</span><span class="s">"(?i)[A-Z]\d{7}"</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div id="outline-container-sec-3" class="outline-1">
<h1 id="sec-3"><span class="section-number-1">3</span> Gateway Display</h1>
<div class="outline-text-1" id="text-3">
<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv">gateway-display</span> <span class="p">[]</span>
  <span class="p">(</span><span class="nf">layout/login</span> <span class="p">[</span><span class="ss">:section</span> <span class="p">{</span><span class="ss">:class</span> <span class="s">"gateway"</span><span class="p">}</span>
		 <span class="p">[</span><span class="ss">:header</span>
		  <span class="p">[</span><span class="ss">:div</span> <span class="p">{</span><span class="ss">:class</span> <span class="s">"verse-logo"</span><span class="p">}</span> <span class="s">"logo"</span><span class="p">]</span>
		  <span class="p">[</span><span class="ss">:h1</span> <span class="s">"Welcome to "</span> <span class="p">[</span><span class="ss">:strong</span> <span class="s">"NCLVerse"</span><span class="p">]]]</span>
		 <span class="p">(</span><span class="nf">form-to</span>
		  <span class="p">[</span><span class="ss">:post</span> <span class="s">"/login"</span><span class="p">]</span>
		  <span class="p">(</span><span class="nf">text-field</span> <span class="p">{</span><span class="ss">:class</span> <span class="s">"username"</span> <span class="ss">:placeholder</span> <span class="s">"NCL StudentID"</span><span class="p">}</span> <span class="s">"username"</span><span class="p">)</span>
		  <span class="p">(</span><span class="nf">password-field</span> <span class="p">{</span><span class="ss">:class</span> <span class="s">"password"</span> <span class="ss">:placeholder</span> <span class="s">"Password"</span><span class="p">}</span> <span class="s">"password"</span><span class="p">)</span>
		  <span class="p">(</span><span class="nf">submit-button</span> <span class="s">"Login"</span><span class="p">))]))</span>
</pre></div>

</div>
</div>
</div>

<div id="outline-container-sec-4" class="outline-1">
<h1 id="sec-4"><span class="section-number-1">4</span> Scraper</h1>
<div class="outline-text-1" id="text-4">
<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv">scraper</span> <span class="p">[</span><span class="nb">name </span><span class="nv">pass</span><span class="p">]</span>
  <span class="p">(</span><span class="nf">leech/ness</span> <span class="nb">name </span><span class="nv">pass</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div id="outline-container-sec-5" class="outline-1">
<h1 id="sec-5"><span class="section-number-1">5</span> Get credentials</h1>
<div class="outline-text-1" id="text-5">
<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv">get-credentials</span> <span class="p">[</span><span class="nv">page</span><span class="p">]</span>
  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">area</span> <span class="p">(</span><span class="nf">enlive/select</span> <span class="nv">page</span> <span class="p">[</span><span class="err">:</span><span class="o">#</span><span class="nv">uname</span> <span class="ss">:span</span><span class="p">])</span>
	<span class="nv">details</span> <span class="p">(</span><span class="nb">apply str </span><span class="p">(</span><span class="nb">some </span><span class="ss">:content</span> <span class="nv">area</span><span class="p">))</span>
	<span class="nv">student-id</span> <span class="p">(</span><span class="nb">second </span><span class="p">(</span><span class="nb">re-find </span><span class="o">#</span><span class="s">"\((\d+)\)"</span> <span class="nv">details</span><span class="p">))</span>
	<span class="nb">name </span><span class="p">(</span><span class="nb">second </span><span class="p">(</span><span class="nb">re-find </span><span class="o">#</span><span class="s">"(.*)\("</span> <span class="nv">details</span><span class="p">))]</span>
    <span class="p">{</span><span class="ss">:id</span> <span class="nv">student-id</span> <span class="ss">:name</span> <span class="p">(</span><span class="nf">clojure.string/trim</span> <span class="nv">name</span><span class="p">)}))</span>
</pre></div>

</div>
</div>
</div>

<div id="outline-container-sec-6" class="outline-1">
<h1 id="sec-6"><span class="section-number-1">6</span> Get modules</h1>
<div class="outline-text-1" id="text-6">
<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv">get-modules</span> <span class="p">[</span><span class="nv">page</span><span class="p">]</span>
  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">modules</span> <span class="p">(</span><span class="nb">mapcat </span><span class="ss">:content</span> <span class="p">(</span><span class="nf">enlive/select</span> <span class="p">(</span><span class="nf">enlive/select</span> <span class="nv">page</span> <span class="p">[</span><span class="err">:</span><span class="o">#</span><span class="nv">topmenu</span><span class="p">])</span> <span class="p">[</span><span class="ss">:a</span><span class="p">]))]</span>
    <span class="p">{</span><span class="ss">:modules</span> <span class="p">(</span><span class="nf">clojure.string/join</span> <span class="s">" "</span> <span class="nv">modules</span><span class="p">)}))</span>
</pre></div>

</div>

<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv">exam-scrape</span> <span class="p">[</span><span class="nv">id</span> <span class="nv">password</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">if-let </span><span class="p">[</span><span class="nv">page</span> <span class="p">(</span><span class="nf">enlive/html-snippet</span> <span class="p">(</span><span class="ss">:body</span> <span class="p">(</span><span class="ss">:response</span> <span class="p">(</span><span class="nf">scraper</span> <span class="nv">id</span> <span class="nv">password</span><span class="p">))))]</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">and </span><span class="p">(</span><span class="nf">get-credentials</span> <span class="nv">page</span><span class="p">)</span> <span class="p">(</span><span class="nf">get-modules</span> <span class="nv">page</span><span class="p">))</span> 
      <span class="p">(</span><span class="nb">merge </span><span class="p">(</span><span class="nf">get-credentials</span> <span class="nv">page</span><span class="p">)</span> <span class="p">(</span><span class="nf">get-modules</span> <span class="nv">page</span><span class="p">))</span> <span class="nv">false</span><span class="p">)</span> <span class="nv">false</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div id="outline-container-sec-7" class="outline-1">
<h1 id="sec-7"><span class="section-number-1">7</span> Validation</h1>
<div class="outline-text-1" id="text-7">
<div class="org-src-container">

<div class="highlight"><pre><span class="nv">When</span> <span class="nv">there</span><span class="ss">'s</span> <span class="nv">a</span> <span class="nv">valid</span> <span class="nv">login</span>, <span class="nv">but</span> <span class="nv">the</span> <span class="nv">app</span> <span class="nv">is</span> <span class="nb">not </span><span class="nv">yet</span> <span class="nv">ready</span>, <span class="nv">show</span> <span class="nv">an</span> <span class="nv">alert</span> <span class="nv">message.</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">valid?</span> <span class="p">[</span><span class="nv">username</span> <span class="nv">pass</span><span class="p">]</span> <span class="p">(</span><span class="nb">re-matches </span><span class="nv">login-regex</span> <span class="nv">username</span><span class="p">))</span>
</pre></div>

</div>
</div>

<div id="outline-container-sec-7-1" class="outline-2">
<h2 id="sec-7-1"><span class="section-number-2">7.1</span> Check for Demo</h2>
<div class="outline-text-2" id="text-7-1">
<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv">demo?</span> <span class="p">[</span><span class="nv">username</span> <span class="nv">pass</span><span class="p">]</span> <span class="p">(</span><span class="nb">and </span><span class="p">(</span><span class="nb">= </span><span class="nv">username</span> <span class="s">"demo"</span><span class="p">)</span> <span class="p">(</span><span class="nb">= </span><span class="nv">pass</span> <span class="s">"please"</span><span class="p">)))</span>
</pre></div>

</div>

<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv">in?</span> <span class="p">[</span><span class="nv">cookies</span><span class="p">]</span> <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">verify</span> <span class="o">#</span><span class="p">(</span><span class="nb">contains? </span><span class="nv">cookies</span> <span class="nv">%</span><span class="p">)]</span>
		      <span class="p">(</span><span class="nb">and </span><span class="p">(</span><span class="nf">verify</span> <span class="s">"id"</span><span class="p">)</span> <span class="p">(</span><span class="nf">verify</span> <span class="s">"name"</span><span class="p">)</span> <span class="p">(</span><span class="nf">verify</span> <span class="s">"modules"</span><span class="p">))))</span>
</pre></div>

</div>

<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="k">def </span><span class="nv">demo-response</span> <span class="p">(</span><span class="nb">assoc </span><span class="p">(</span><span class="nf">resp/redirect</span> <span class="s">"/"</span><span class="p">)</span> <span class="ss">:cookies</span> <span class="p">{</span><span class="s">"id"</span> <span class="p">{</span><span class="ss">:value</span> <span class="s">"B0123456"</span><span class="p">}</span> <span class="s">"name"</span> <span class="p">{</span><span class="ss">:value</span> <span class="s">"The Dude"</span><span class="p">}</span> <span class="s">"modules"</span> <span class="p">{</span><span class="ss">:value</span> <span class="s">"CSC3221 CSC3223 CSC3324 CSC3423 CSC3621"</span><span class="p">}}))</span>
</pre></div>

</div>

<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv">login</span> <span class="p">[</span><span class="nv">username</span> <span class="nv">password</span> <span class="nv">cookies</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">cond </span><span class="p">(</span><span class="nf">demo?</span> <span class="nv">username</span> <span class="nv">password</span><span class="p">)</span> <span class="nv">demo-response</span>
	<span class="p">(</span><span class="nf">valid?</span> <span class="nv">username</span> <span class="nv">password</span><span class="p">)</span>
	<span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">ness-data</span> <span class="p">(</span><span class="nf">exam-scrape</span> <span class="nv">username</span> <span class="nv">password</span><span class="p">)]</span> <span class="p">(</span><span class="nb">assoc </span><span class="p">(</span><span class="nf">resp/redirect</span> <span class="s">"/"</span><span class="p">)</span> <span class="ss">:cookies</span> <span class="nv">ness-data</span><span class="p">))</span>
	<span class="ss">:else</span> <span class="p">(</span><span class="nf">gateway-display</span><span class="p">)))</span>
</pre></div>

</div>

<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv">logout</span> <span class="p">[</span><span class="nv">req</span><span class="p">]</span>
  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">clear-value</span> <span class="p">{</span><span class="ss">:value</span> <span class="s">""</span> <span class="ss">:max-age</span> <span class="mi">0</span><span class="p">}]</span>
    <span class="p">(</span><span class="nf">update-in</span> <span class="p">(</span><span class="nf">resp/redirect</span> <span class="s">"/login"</span><span class="p">)</span> <span class="p">[</span><span class="ss">:cookies</span><span class="p">]</span> <span class="nb">merge </span><span class="p">{</span><span class="s">"id"</span> <span class="nv">clear-value</span> <span class="s">"name"</span> <span class="nv">clear-value</span> <span class="s">"modules"</span> <span class="nv">clear-value</span><span class="p">})))</span>
</pre></div>

</div>

<div class="org-src-container">

<div class="highlight"><pre><span class="nv">Find</span> <span class="nv">a</span> <span class="nv">way</span> <span class="nv">to</span> <span class="nv">flash</span> <span class="nv">alerts</span> <span class="nb">when </span><span class="nv">the</span> <span class="nv">login</span> <span class="nv">is</span> <span class="nv">wrong</span>
<span class="p">(</span><span class="nf">defroutes</span> <span class="nv">gateway-routes</span>
  <span class="p">(</span><span class="nf">GET</span> <span class="s">"/login"</span> <span class="p">{</span><span class="nv">cookies</span> <span class="ss">:cookies</span><span class="p">}</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">in?</span> <span class="nv">cookies</span><span class="p">)</span> <span class="p">(</span><span class="nf">resp/redirect</span> <span class="s">"/"</span><span class="p">)</span> <span class="p">(</span><span class="nf">gateway-display</span><span class="p">)))</span>
  <span class="p">(</span><span class="nf">POST</span> <span class="s">"/login"</span> <span class="p">[</span><span class="nv">username</span> <span class="nv">password</span> <span class="ss">:as</span> <span class="p">{</span><span class="nv">cookies</span> <span class="ss">:cookies</span><span class="p">}]</span>
	<span class="p">(</span><span class="nb">cond </span><span class="p">(</span><span class="nf">demo?</span> <span class="nv">username</span> <span class="nv">password</span><span class="p">)</span> <span class="nv">demo-response</span>
	      <span class="p">(</span><span class="nf">valid?</span> <span class="nv">username</span> <span class="nv">password</span><span class="p">)</span>
	      <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">ness-data</span> <span class="p">(</span><span class="nf">exam-scrape</span> <span class="nv">username</span> <span class="nv">password</span><span class="p">)]</span> <span class="p">(</span><span class="nb">assoc </span><span class="p">(</span><span class="nf">resp/redirect</span> <span class="s">"/"</span><span class="p">)</span> <span class="ss">:cookies</span> <span class="nv">ness-data</span><span class="p">))</span>
	      <span class="ss">:else</span> <span class="p">(</span><span class="nf">gateway-display</span><span class="p">)))</span>
  <span class="p">(</span><span class="nf">POST</span> <span class="s">"/logout"</span> <span class="nv">req</span> <span class="p">(</span><span class="nf">logout</span> <span class="nv">req</span><span class="p">)))</span>
</pre></div>

</div>
</div>
</div>
</div>
</section>

</article></section>
    </section>
  </body>

</html>