<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Namespaces</title>
<link href="http://fonts.googleapis.com/css?family=Fira+Sans:300,400,500,700|Inconsolata" rel="stylesheet" type="text/css" />

    <link href="http://nclverse.github.io/code/css/styles.css" media="all" rel="stylesheet" type="text/css" />
  </head>
  <body>
    <section id="container">
      <section id="sidebar"><nav id="main-nav">
  <header id="title">
    <img class="site-logo" alt="logo" src="http://nclverse.github.io/code/img/logo.svg" />
    <div class="titles">
      <span class="verse-title">NCL<strong>Verse</strong></span>
      <ul class="docs-site">
        <li><a class="active" href="http://nclverse.github.io/code">Code</a></li><li><a href="http://nclverse.github.io/dissertation">Dissertation</a></li><li><a href="http://nclverse.github.io/design">Design</a></li><li><a href="http://nclverse.github.io/help">Help</a></li>
      </ul>
    </div>
  </header>
  <div class="category">
    <header class="category-title"><h1>apps<span class="count">234 LOC</span></h1></header>
    <ul class="titles">
      <li><a class="title-link">Architecture<span class="count">0 LOC</span></a>
        <ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/apps/architecture/core-ideas.html">Core Ideas<span class="count">0</span></a></li></ul>
      </li>
      </ul><ul class="titles">
      <li><a class="title-link">Exams<span class="count">234 LOC</span></a>
        <ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/apps/exams/leechness.html">Leechness<span class="count">24</span></a></li></ul><ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/apps/exams/gateway.html">Gateway<span class="count">56</span></a></li></ul><ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/apps/exams/handler.html">Handler<span class="count">18</span></a></li></ul><ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/apps/exams/home.html">Home<span class="count">56</span></a></li></ul><ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/apps/exams/layout.html">Layout<span class="count">39</span></a></li></ul><ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/apps/exams/transforms.html">Transforms<span class="count">41</span></a></li></ul>
      </li>
      </ul>
  </div><div class="category">
    <header class="category-title"><h1>utilities<span class="count">269 LOC</span></h1></header>
    <ul class="titles">
      <li><a class="title-link active">Docs Generator<span class="count">269 LOC</span></a>
        <ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/utilities/docs-generator/architecture.html">Architecture<span class="count">0</span></a></li></ul><ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/utilities/docs-generator/overview.html">Overview<span class="count">0</span></a></li></ul><ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/utilities/docs-generator/collect.html">Collect<span class="count">48</span></a></li></ul><ul class="subtitles"><li> <a class="subtitle-link active" href="http://nclverse.github.io/code/utilities/docs-generator/transform.html">Transform<span class="count">95</span></a></li></ul><ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/utilities/docs-generator/render.html">Render<span class="count">126</span></a></li></ul><ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/utilities/docs-generator/roadmap.html">Roadmap<span class="count">0</span></a></li></ul>
      </li>
      </ul>
  </div><div class="category">
    <header class="category-title"><h1>tests<span class="count">95 LOC</span></h1></header>
    <ul class="titles">
      <li><a class="title-link">Docs Generator<span class="count">95 LOC</span></a>
        <ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/tests/docs-generator/collect.html">Collect<span class="count">45</span></a></li></ul><ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/tests/docs-generator/transform.html">Transform<span class="count">20</span></a></li></ul><ul class="subtitles"><li> <a class="subtitle-link" href="http://nclverse.github.io/code/tests/docs-generator/render.html">Render<span class="count">30</span></a></li></ul>
      </li>
      </ul>
  </div>

</nav></section>
      <section id="read-area"><article class="post">
  <section class="content">
<div id="outline-container-sec-1" class="outline-1">
<h1 id="sec-1">Namespaces</h1>
<div class="outline-text-1" id="text-1">
<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="kd">ns </span><span class="nv">docs-gen.transform</span>
  <span class="p">(</span><span class="ss">:require</span> <span class="p">[</span><span class="nv">prone.debug</span> <span class="ss">:refer</span> <span class="p">[</span><span class="nv">debug</span><span class="p">]])</span>
  <span class="p">(</span><span class="ss">:use</span> <span class="p">[</span><span class="nv">net.cgrand.enlive-html</span><span class="p">]</span>
	<span class="p">[</span><span class="nv">clygments.core</span><span class="p">]))</span>
</pre></div>

</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-1">
<h1 id="sec-2">Layout Helpers</h1>
<div class="outline-text-1" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-2">
<h2 id="sec-2-1">Build Drop Down</h2>
<div class="outline-text-2" id="text-2-1">
<p>
Builds the site dropdown
</p>

<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv">build-drop-down</span> <span class="p">[</span><span class="nv">site</span> <span class="nv">sites</span><span class="p">]</span>
<span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">websites</span> <span class="p">(</span><span class="nb">list </span><span class="s">"code"</span> <span class="s">"dissertation"</span><span class="p">)]</span>
  <span class="c1">;Inorder to maintain site always as the first element in the row</span>
  <span class="c1">;Alert: Pretty hacky</span>
  <span class="p">(</span><span class="nf">clone-for</span> <span class="p">[</span><span class="nv">s</span> <span class="p">(</span><span class="nb">into </span><span class="p">[</span><span class="nv">site</span><span class="p">]</span> <span class="p">(</span><span class="nb">remove </span><span class="o">#</span><span class="p">(</span><span class="nb">= </span><span class="nv">%</span> <span class="nv">site</span><span class="p">)</span> <span class="nv">sites</span><span class="p">))]</span>
	     <span class="p">[</span><span class="ss">:a</span><span class="p">]</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">s</span> <span class="nv">site</span><span class="p">)</span> <span class="p">(</span><span class="nf">do-&gt;</span> <span class="p">(</span><span class="nf">add-class</span> <span class="s">"active"</span><span class="p">)</span>
				       <span class="p">(</span><span class="nf">set-attr</span> <span class="ss">:href</span> <span class="p">(</span><span class="nb">str </span><span class="s">"/"</span> <span class="nv">s</span><span class="p">))</span>
				       <span class="p">(</span><span class="nf">content</span> <span class="p">(</span><span class="nf">clojure.string/capitalize</span> <span class="nv">s</span><span class="p">)))</span>
		      <span class="p">(</span><span class="nf">do-&gt;</span> <span class="p">(</span><span class="nf">set-attr</span> <span class="ss">:href</span> <span class="p">(</span><span class="nb">str </span><span class="s">"/"</span> <span class="nv">s</span><span class="p">))</span> <span class="p">(</span><span class="nf">content</span> <span class="p">(</span><span class="nf">clojure.string/capitalize</span> <span class="nv">s</span><span class="p">)))))))</span>
</pre></div>

</div>
</div>
</div>
</div>

<div id="outline-container-sec-3" class="outline-1">
<h1 id="sec-3">Enlive Helpers</h1>
<div class="outline-text-1" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-2">
<h2 id="sec-3-1">Update Attribute Helper</h2>
<div class="outline-text-2" id="text-3-1">
<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv">update-attr</span> <span class="p">[</span><span class="nv">attr</span> <span class="nv">f</span> <span class="o">&amp;</span> <span class="nv">args</span><span class="p">]</span>
  <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">node</span><span class="p">]</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">get </span><span class="p">(</span><span class="ss">:attrs</span> <span class="nv">node</span><span class="p">)</span> <span class="nv">attr</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">apply </span><span class="nv">update-in</span> <span class="nb">node </span><span class="p">[</span><span class="ss">:attrs</span> <span class="nv">attr</span><span class="p">]</span> <span class="nv">f</span> <span class="nv">args</span><span class="p">)</span> <span class="nv">node</span><span class="p">)))</span>
</pre></div>

</div>
</div>
</div>
</div>

<div id="outline-container-sec-4" class="outline-1">
<h1 id="sec-4">Transform Inline URLs</h1>
<div class="outline-text-1" id="text-4">
<p>
Attach root site to inline URLs
</p>

<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv">url-transform</span> <span class="p">[</span><span class="nb">root </span><span class="nv">site</span> <span class="nv">url</span><span class="p">]</span>
<span class="p">(</span><span class="nf">cond</span>
<span class="p">(</span><span class="nf">.startsWith</span> <span class="nv">url</span> <span class="s">"/"</span><span class="p">)</span> <span class="p">(</span><span class="nb">str root </span><span class="nv">url</span><span class="p">)</span>
<span class="p">(</span><span class="nf">.startsWith</span> <span class="nv">url</span> <span class="s">"./"</span><span class="p">)</span> <span class="p">(</span><span class="nb">str root </span><span class="s">"/"</span> <span class="nv">site</span> <span class="p">(</span><span class="nf">clojure.string/replace-first</span> <span class="nv">url</span> <span class="o">#</span><span class="s">"."</span> <span class="s">""</span><span class="p">))</span>
<span class="p">(</span><span class="nf">.startsWith</span> <span class="nv">url</span> <span class="s">"http"</span><span class="p">)</span> <span class="nv">url</span>
<span class="ss">:else</span> <span class="s">"Malformed"</span><span class="p">))</span>
</pre></div>

</div>

<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv">attach-root</span> <span class="p">[</span><span class="nb">root </span><span class="nv">site</span> <span class="nv">page</span><span class="p">]</span>
<span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">update-fn</span> <span class="o">#</span><span class="p">(</span><span class="nf">update-attr</span> <span class="nv">%</span> <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">current</span><span class="p">]</span> <span class="p">(</span><span class="nf">url-transform</span> <span class="nb">root </span><span class="nv">site</span> <span class="nv">current</span><span class="p">)))]</span>
<span class="p">(</span><span class="nb">apply str </span><span class="p">(</span><span class="nf">emit*</span> <span class="p">(</span><span class="nf">at</span> <span class="p">(</span><span class="nf">html-resource</span> <span class="p">(</span><span class="nf">java.io.StringReader.</span> <span class="nv">page</span><span class="p">))</span>
		      <span class="p">[</span><span class="ss">:a</span><span class="p">]</span> <span class="p">(</span><span class="nf">update-fn</span> <span class="ss">:href</span><span class="p">)</span>
		      <span class="p">[</span><span class="ss">:link</span><span class="p">]</span> <span class="p">(</span><span class="nf">update-fn</span> <span class="ss">:href</span><span class="p">)</span>
		      <span class="p">[</span><span class="ss">:img</span><span class="p">]</span> <span class="p">(</span><span class="nf">update-fn</span> <span class="ss">:src</span><span class="p">))))))</span>
</pre></div>

</div>
</div>
</div>

<div id="outline-container-sec-5" class="outline-1">
<h1 id="sec-5">Navigation Helpers</h1>
<div class="outline-text-1" id="text-5">
<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv">matches</span> <span class="p">[</span><span class="nv">k</span> <span class="nv">v</span> <span class="nv">m</span><span class="p">]</span> <span class="p">(</span><span class="nb">filter </span><span class="o">#</span><span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nf">k</span> <span class="nv">%</span><span class="p">)</span> <span class="nv">v</span><span class="p">)</span> <span class="nv">m</span><span class="p">))</span>

<span class="p">(</span><span class="kd">defn </span><span class="nv">meta-map</span> <span class="p">[</span><span class="nv">k</span><span class="p">]</span>
<span class="p">(</span><span class="nb">or </span><span class="p">({</span><span class="ss">:loc</span> <span class="s">" LOC"</span>
<span class="ss">:words</span> <span class="s">" Words"</span><span class="p">}</span> <span class="nv">k</span><span class="p">)</span> <span class="s">"Unknown Metadata"</span><span class="p">))</span>

<span class="p">(</span><span class="kd">defn </span><span class="nv">sum-count</span> <span class="p">[</span><span class="nv">m</span> <span class="nv">k</span> <span class="nv">v</span> <span class="nv">coll</span><span class="p">]</span>
  <span class="p">{</span><span class="ss">:pre</span> <span class="p">[(</span><span class="nb">every? </span><span class="o">#</span><span class="p">(</span><span class="nb">or </span><span class="p">(</span><span class="nb">contains? </span><span class="nv">%</span> <span class="ss">:loc</span><span class="p">)</span> <span class="p">(</span><span class="nb">contains? </span><span class="nv">%</span> <span class="ss">:words</span><span class="p">))</span> <span class="nv">coll</span><span class="p">)]}</span>
  <span class="p">(</span><span class="nb">reduce + </span><span class="p">(</span><span class="nb">map </span><span class="nv">m</span> <span class="p">(</span><span class="nf">matches</span> <span class="nv">k</span> <span class="nv">v</span> <span class="nv">coll</span><span class="p">))))</span>

<span class="p">(</span><span class="kd">defn </span><span class="nv">build-meta-strings</span> <span class="p">[</span><span class="nv">metadata</span> <span class="nv">k</span> <span class="nv">v</span> <span class="nv">coll</span><span class="p">]</span>
<span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">m</span> <span class="p">(</span><span class="nb">first </span><span class="nv">metadata</span><span class="p">)]</span>
<span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">not-empty</span> <span class="nv">metadata</span><span class="p">)</span>
<span class="p">(</span><span class="nf">html</span> <span class="p">[</span><span class="ss">:span.count</span> <span class="p">(</span><span class="nb">str </span><span class="p">(</span><span class="nf">sum-count</span> <span class="nv">m</span> <span class="nv">k</span> <span class="nv">v</span> <span class="nv">coll</span><span class="p">)</span> <span class="p">(</span><span class="nf">meta-map</span> <span class="nv">m</span><span class="p">))])</span> <span class="s">""</span><span class="p">)))</span>
</pre></div>

</div>
</div>
</div>

<div id="outline-container-sec-6" class="outline-1">
<h1 id="sec-6">Check for presence of all</h1>
<div class="outline-text-1" id="text-6">
<p>
Duct tape functions.
</p>

<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="k">def </span><span class="nv">clean-numbering</span> <span class="o">#</span><span class="p">(</span><span class="nf">clojure.string/replace</span> <span class="nv">%</span> <span class="o">#</span><span class="s">"\d+-"</span> <span class="s">""</span><span class="p">))</span>
</pre></div>

</div>
</div>


<div id="outline-container-sec-6-0-1" class="outline-3">
<h3 id="sec-6-0-1">Format Navigation Links</h3>
<div class="outline-text-3" id="text-6-0-1">
<p>
Helper functions to strip all numbers followed by a single hyphen. Used to format the
URLs which have Kebab case.
</p>

<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv">format-nav-links</span> <span class="p">[</span><span class="nv">word</span><span class="p">]</span>
  <span class="p">(</span><span class="nf">clojure.string/join</span> <span class="s">" "</span> <span class="p">(</span><span class="nb">map </span><span class="nv">clojure.string/capitalize</span> <span class="p">(</span><span class="nf">clojure.string/split</span> <span class="p">(</span><span class="nf">clean-numbering</span> <span class="nv">word</span><span class="p">)</span> <span class="o">#</span><span class="s">"-"</span><span class="p">))))</span>

<span class="p">(</span><span class="kd">defn </span><span class="nv">rebuild-url</span> <span class="p">[</span><span class="nv">site</span> <span class="nv">s</span><span class="p">]</span>
<span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">format</span> <span class="o">#</span><span class="p">(</span><span class="nb">str </span><span class="s">"/"</span> <span class="nv">site</span> <span class="s">"/"</span> <span class="p">(</span><span class="nb">apply str </span><span class="nv">%</span><span class="p">)</span> <span class="s">".html"</span><span class="p">)]</span>
<span class="p">(</span><span class="nf">format</span> <span class="p">(</span><span class="nf">interpose</span> <span class="s">"/"</span> <span class="p">(</span><span class="nb">map </span><span class="nv">clean-numbering</span> <span class="p">((</span><span class="nf">juxt</span> <span class="ss">:category</span> <span class="ss">:title</span> <span class="ss">:subtitle</span><span class="p">)</span> <span class="nv">s</span><span class="p">))))))</span>
</pre></div>

</div>

<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv">has-all-keys?</span> <span class="p">[</span><span class="nv">nav-entry</span><span class="p">]</span>
<span class="p">(</span><span class="k">let </span><span class="p">[{</span><span class="ss">:keys</span> <span class="p">[</span><span class="nv">category</span> <span class="nv">title</span> <span class="nv">subtitle</span><span class="p">]}</span> <span class="nv">nav-entry</span><span class="p">]</span>
<span class="p">(</span><span class="nb">every? </span><span class="o">#</span><span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">nil? </span><span class="nv">%</span><span class="p">))</span> <span class="p">(</span><span class="nb">list </span><span class="nv">category</span> <span class="nv">title</span> <span class="nv">subtitle</span><span class="p">))))</span>

<span class="p">(</span><span class="kd">defn </span><span class="nv">leaf-nodes</span> <span class="p">[</span><span class="nv">nav</span><span class="p">]</span>
<span class="p">(</span><span class="nb">filter </span><span class="nv">has-all-keys?</span> <span class="nv">nav</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>
</div>

<div id="outline-container-sec-7" class="outline-1">
<h1 id="sec-7">Build Subtitles</h1>
<div class="outline-text-1" id="text-7">
<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv">build-subtitles</span> <span class="p">[</span><span class="nv">titles</span> <span class="nv">title</span> <span class="nv">current-subtitle</span> <span class="nv">site</span><span class="p">]</span>
  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">subtitles</span> <span class="p">(</span><span class="nf">matches</span> <span class="ss">:title</span> <span class="nv">title</span> <span class="nv">titles</span><span class="p">)]</span>
    <span class="p">(</span><span class="nf">clone-for</span> <span class="p">[</span><span class="nv">s</span> <span class="nv">subtitles</span><span class="p">]</span>
	       <span class="p">[</span><span class="ss">:li</span> <span class="ss">:a.subtitle-link</span><span class="p">]</span> <span class="p">(</span><span class="nf">do-&gt;</span> <span class="p">(</span><span class="nf">set-attr</span> <span class="ss">:href</span> <span class="p">(</span><span class="nf">rebuild-url</span> <span class="nv">site</span> <span class="nv">s</span><span class="p">))</span>
					    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="ss">:subtitle</span> <span class="nv">s</span><span class="p">)</span> <span class="nv">current-subtitle</span><span class="p">)</span>
					    <span class="p">(</span><span class="nf">update-attr</span> <span class="ss">:class</span>
					    <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="o">&amp;</span> <span class="nv">args</span><span class="p">]</span>
					    <span class="p">(</span><span class="nb">apply str </span><span class="p">(</span><span class="nf">interpose</span> <span class="s">" "</span> <span class="nv">args</span><span class="p">)))</span> <span class="s">"active"</span><span class="p">)</span> <span class="nv">identity</span><span class="p">)</span>
					    <span class="p">(</span><span class="nf">content</span> <span class="p">(</span><span class="nf">format-nav-links</span> <span class="p">(</span><span class="ss">:subtitle</span> <span class="nv">s</span><span class="p">))</span>
						     <span class="p">(</span><span class="nf">html</span> <span class="p">[</span><span class="ss">:span.count</span> <span class="p">(</span><span class="nb">str </span><span class="p">(</span><span class="ss">:loc</span> <span class="nv">s</span><span class="p">))]))))))</span>
</pre></div>

</div>
</div>
</div>

<div id="outline-container-sec-8" class="outline-1">
<h1 id="sec-8">Build Titles</h1>
<div class="outline-text-1" id="text-8">
<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv">highlight-link</span> <span class="p">[</span><span class="nv">link-title</span> <span class="nv">title</span><span class="p">]</span>
<span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">link-title</span> <span class="nv">title</span><span class="p">)</span> <span class="p">(</span><span class="nf">update-attr</span> <span class="ss">:class</span> <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="o">&amp;</span> <span class="nv">args</span><span class="p">]</span> <span class="p">(</span><span class="nb">apply str </span><span class="p">(</span><span class="nf">interpose</span> <span class="s">" "</span> <span class="nv">args</span><span class="p">)))</span> <span class="s">"active"</span><span class="p">)</span> <span class="nv">identity</span><span class="p">))</span>
</pre></div>

</div>

<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv">build-titles</span> <span class="p">[</span><span class="nv">link</span> <span class="nv">c</span> <span class="nv">metadata</span> <span class="nv">titles</span> <span class="nv">nav</span> <span class="nv">site</span><span class="p">]</span>
    <span class="p">(</span><span class="nf">clone-for</span> <span class="p">[</span><span class="nv">t</span> <span class="p">(</span><span class="nb">distinct </span><span class="nv">titles</span><span class="p">)]</span>
	       <span class="p">[</span><span class="ss">:li</span> <span class="ss">:a.title-link</span><span class="p">]</span> <span class="p">(</span><span class="nf">do-&gt;</span> <span class="p">(</span><span class="nf">content</span> <span class="p">(</span><span class="nf">format-nav-links</span> <span class="nv">t</span><span class="p">)</span> <span class="p">(</span><span class="nf">build-meta-strings</span> <span class="nv">metadata</span> <span class="ss">:title</span> <span class="nv">t</span> <span class="nv">nav</span><span class="p">))</span>
						   <span class="p">(</span><span class="nf">highlight-link</span> <span class="p">(</span><span class="ss">:title</span> <span class="nv">link</span><span class="p">)</span> <span class="nv">t</span><span class="p">))</span>
	       <span class="p">[</span><span class="ss">:li</span> <span class="ss">:ul.subtitles</span><span class="p">]</span> <span class="p">(</span><span class="nf">build-subtitles</span> <span class="nv">nav</span> <span class="nv">t</span> <span class="p">(</span><span class="ss">:subtitle</span> <span class="nv">link</span><span class="p">)</span> <span class="nv">site</span><span class="p">)))</span>
</pre></div>

</div>
</div>
</div>

<div id="outline-container-sec-9" class="outline-1">
<h1 id="sec-9">Build Categories</h1>
<div class="outline-text-1" id="text-9">
<p>
Selecting only the valid categories. This means that index.html in
the root directory and such other ones without a leaf node will be omitted.
</p>

<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv">build-categories</span> <span class="p">[</span><span class="nv">link</span> <span class="nv">metadata</span> <span class="nv">nav</span> <span class="nv">site</span><span class="p">]</span>
  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">leaves</span> <span class="p">(</span><span class="nf">leaf-nodes</span> <span class="nv">nav</span><span class="p">)</span>
	<span class="nv">categories</span> <span class="p">(</span><span class="nb">map </span><span class="ss">:category</span> <span class="nv">leaves</span><span class="p">)]</span>
  <span class="p">(</span><span class="nf">clone-for</span> <span class="p">[</span><span class="nv">c</span> <span class="p">(</span><span class="nb">distinct </span><span class="nv">categories</span><span class="p">)]</span>
	     <span class="p">[</span><span class="ss">:header.category-title</span> <span class="ss">:h1</span><span class="p">]</span> <span class="p">(</span><span class="nf">content</span> <span class="nv">c</span> <span class="p">(</span><span class="nf">build-meta-strings</span> <span class="nv">metadata</span> <span class="ss">:category</span> <span class="nv">c</span> <span class="nv">nav</span><span class="p">))</span>
	     <span class="p">[</span><span class="ss">:ul.titles</span><span class="p">]</span> <span class="p">(</span><span class="nf">build-titles</span> <span class="nv">link</span> <span class="nv">c</span> <span class="nv">metadata</span> <span class="p">(</span><span class="nb">map </span><span class="ss">:title</span> <span class="p">(</span><span class="nf">matches</span> <span class="ss">:category</span> <span class="nv">c</span> <span class="nv">nav</span><span class="p">))</span> <span class="nv">nav</span> <span class="nv">site</span><span class="p">))))</span>
</pre></div>

</div>
</div>
</div>

<div id="outline-container-sec-10" class="outline-1">
<h1 id="sec-10">Layout</h1>
<div class="outline-text-1" id="text-10">
<p>
Accepts a page with meta data of the structure.
</p>
</div>

<div id="outline-container-sec-10-1" class="outline-2">
<h2 id="sec-10-1">Syntax Highlighting</h2>
<div class="outline-text-2" id="text-10-1">
<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv">convert-pre</span> <span class="p">[</span><span class="nv">content</span><span class="p">]</span> <span class="p">(</span><span class="nf">html-snippet</span> <span class="p">(</span><span class="nf">highlight</span> <span class="p">(</span><span class="nb">apply str </span><span class="nv">content</span><span class="p">)</span> <span class="ss">:clojure</span> <span class="ss">:html</span><span class="p">)))</span>

<span class="p">(</span><span class="kd">defn </span><span class="nv">syntax-highlight</span> <span class="p">[</span><span class="nv">entry</span><span class="p">]</span>
  <span class="p">(</span><span class="nf">at</span> <span class="p">(</span><span class="nf">html-snippet</span> <span class="nv">entry</span><span class="p">)</span> <span class="p">[</span><span class="ss">:pre</span><span class="p">]</span> <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">nd</span><span class="p">]</span> <span class="p">(</span><span class="nf">convert-pre</span> <span class="p">(</span><span class="ss">:content</span> <span class="nv">nd</span><span class="p">)))))</span>
</pre></div>

</div>
</div>
</div>

<div id="outline-container-sec-10-2" class="outline-2">
<h2 id="sec-10-2">Article</h2>
<div class="outline-text-2" id="text-10-2">
<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="nf">defsnippet</span> <span class="nv">article</span> <span class="s">"templates/article.html"</span> <span class="p">[</span><span class="ss">:article</span><span class="p">]</span> <span class="p">[</span><span class="nv">entry</span><span class="p">]</span>
  <span class="p">[</span><span class="ss">:article</span> <span class="ss">:.content</span><span class="p">]</span> <span class="p">(</span><span class="nf">content</span> <span class="p">(</span><span class="nf">syntax-highlight</span> <span class="nv">entry</span><span class="p">)))</span>
</pre></div>

</div>
</div>
</div>

<div id="outline-container-sec-10-3" class="outline-2">
<h2 id="sec-10-3">Sidebar</h2>
<div class="outline-text-2" id="text-10-3">
<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="nf">defsnippet</span> <span class="nv">sidebar</span> <span class="s">"templates/sidebar.html"</span> <span class="p">[</span><span class="ss">:nav</span><span class="p">]</span> <span class="p">[</span><span class="nv">current-url</span> <span class="nv">site</span> <span class="nv">metadata</span> <span class="nv">sites</span> <span class="nv">nav</span> <span class="nv">page</span><span class="p">]</span>
  <span class="p">[</span><span class="ss">:img.site-logo</span><span class="p">]</span> <span class="p">(</span><span class="nf">set-attr</span> <span class="ss">:src</span> <span class="s">"./img/logo.svg"</span><span class="p">)</span>
  <span class="p">[</span><span class="ss">:ul.docs-site</span> <span class="ss">:li</span><span class="p">]</span> <span class="p">(</span><span class="nf">build-drop-down</span> <span class="nv">site</span> <span class="nv">sites</span><span class="p">)</span>
  <span class="p">[</span><span class="ss">:div.category</span><span class="p">]</span> <span class="p">(</span><span class="nf">build-categories</span> <span class="nv">current-url</span> <span class="nv">metadata</span> <span class="nv">nav</span> <span class="nv">site</span><span class="p">))</span>
</pre></div>

</div>


<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="nf">deftemplate</span> <span class="nv">layout</span> <span class="s">"templates/layout.html"</span> <span class="p">[</span><span class="nv">site</span> <span class="nv">metadata</span> <span class="nv">sites</span> <span class="nv">nav</span> <span class="nv">page</span><span class="p">]</span>
  <span class="p">[</span><span class="ss">:title</span><span class="p">]</span> <span class="p">(</span><span class="nf">content</span> <span class="p">(</span><span class="ss">:title</span> <span class="p">(</span><span class="ss">:meta</span> <span class="nv">page</span><span class="p">)))</span>
  <span class="p">[</span><span class="err">:</span><span class="o">#</span><span class="nv">sidebar</span><span class="p">]</span>  <span class="p">(</span><span class="nf">content</span> <span class="p">(</span><span class="nf">sidebar</span> <span class="p">(</span><span class="ss">:url</span> <span class="nv">page</span><span class="p">)</span> <span class="nv">site</span> <span class="nv">metadata</span> <span class="nv">sites</span> <span class="nv">nav</span> <span class="nv">page</span><span class="p">))</span>
  <span class="p">[</span><span class="err">:</span><span class="o">#</span><span class="nv">container</span> <span class="err">:</span><span class="o">#</span><span class="nv">read-area</span><span class="p">]</span> <span class="p">(</span><span class="nf">content</span> <span class="p">(</span><span class="nf">article</span> <span class="p">(</span><span class="ss">:page</span> <span class="nv">page</span><span class="p">))))</span>
</pre></div>

</div>
</div>
</div>

<div id="outline-container-sec-10-4" class="outline-2">
<h2 id="sec-10-4">Transform Page</h2>
<div class="outline-text-2" id="text-10-4">
<div class="org-src-container">

<div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv">transform-page</span> <span class="p">[</span><span class="nb">root </span><span class="nv">site</span> <span class="nv">metadata</span> <span class="nv">sites</span> <span class="nv">nav</span> <span class="nv">page</span><span class="p">]</span>
    <span class="p">(</span><span class="nf">attach-root</span> <span class="nb">root </span><span class="nv">site</span> <span class="p">(</span><span class="nb">apply str </span><span class="p">(</span><span class="nf">layout</span> <span class="nv">site</span> <span class="nv">metadata</span> <span class="nv">sites</span> <span class="nv">nav</span> <span class="nv">page</span><span class="p">))))</span>
</pre></div>

</div>
</div>
</div>
</div>
</section>

</article></section>
    </section>
  </body>

</html>